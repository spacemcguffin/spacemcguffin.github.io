<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Notes</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg: #f5f5f7;
  --panel: #ffffff;
  --border: #e6e6e8;
  --text: #111111;
  --muted: #6e6e73;
  --muted2: #9b9ba1;

  --avatarBg: #e2e2e5;
  --tagBg: rgba(0,0,0,.04);
  --tagBorder: rgba(0,0,0,.10);

  --maxw: 720px;
  --topbarH: 56px;
}

:root[data-theme="dark"]{
  --bg: #0f1220;
  --panel: #151a2f;
  --border: rgba(255,255,255,.08);

  --text: rgba(255,255,255,.92);
  --muted: rgba(255,255,255,.65);
  --muted2: rgba(255,255,255,.45);

  --avatarBg: rgba(255,255,255,.08);
  --tagBg: rgba(255,255,255,.05);
  --tagBorder: rgba(255,255,255,.10);
}

*{box-sizing:border-box;}

body{
  margin:0;
  font-family:'Inter', system-ui, sans-serif;
  background: var(--bg);
  color: var(--text);
  -webkit-font-smoothing: antialiased;
}

.topbar{
  position:fixed;
  top:0; left:0; right:0;
  height:var(--topbarH);
  z-index:100;

  background: color-mix(in srgb, var(--panel) 82%, transparent);
  border-bottom:1px solid color-mix(in srgb, var(--border) 85%, transparent);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);

  display:flex;
  align-items:center;
}

.wrap{
  max-width:var(--maxw);
  margin:0 auto;
  padding:0 16px;
  width:100%;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.brand{
  font-weight:600;
  font-size:15px;
  display:flex;
  align-items:center;
  gap:8px;
}

.brand__dot{
  width:8px;
  height:8px;
  border-radius:999px;
  background: var(--text);
}

.topbar__right{
  display:flex;
  align-items:center;
  gap:10px;
}

.sortSelect,
.themeBtn{
  height:34px;
  border-radius:999px;
  border:1px solid var(--border);
  background: var(--panel);
  color: var(--text);
  padding:0 14px;
  font-size:13px;
  cursor:pointer;
}

/* ✅ NEW: spacer so header isn't hidden under fixed bar */
.topInset{
  height: var(--topbarH);
}

/* Layout */
.layout{
  max-width:var(--maxw);
  margin:0 auto;
  padding:0 16px 40px;
}

.timelineHead{
  padding:20px 0 10px;
}

h1{
  margin:0;
  font-size:20px;
  font-weight:600;
}

.subtitle{
  margin-top:4px;
  font-size:13px;
  color:var(--muted);
}

.controls{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  margin-top:14px;
}

.input,.select{
  height:38px;
  border-radius:10px;
  border:1px solid var(--border);
  background: var(--panel);
  color: var(--text);
  padding:0 12px;
  font-size:14px;
}

.btn{
  height:38px;
  border-radius:999px;
  border:1px solid var(--border);
  background: var(--panel);
  color: var(--text);
  padding:0 14px;
  font-size:14px;
  cursor:pointer;
}

.feed{
  margin-top:10px;
}

.feed.isAnimating{
  animation: fade .18s ease-out both;
}

@keyframes fade{
  from{opacity:0; transform:translateY(4px);}
  to{opacity:1; transform:translateY(0);}
}

.post{
  display:grid;
  grid-template-columns:46px 1fr;
  gap:12px;
  padding:18px 0;
  border-bottom:1px solid var(--border);
}

.post__avatar{
  width:38px;
  height:38px;
  border-radius:999px;
  background: var(--avatarBg);
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:600;
  font-size:13px;
  overflow:hidden;
}

.post__avatar img{
  width:100%;
  height:100%;
  object-fit:cover;
}

.post__top{
  display:flex;
  gap:8px;
  align-items:center;
}

.post__name{
  font-weight:600;
  font-size:14px;
}

.post__time{
  font-size:13px;
  color:var(--muted2);
}

.post__text{
  margin:6px 0 8px;
  line-height:1.6;
  font-size:15px;
  white-space:pre-wrap;
}

.tags{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}

.tagBtn{
  font-size:12px;
  border:1px solid var(--tagBorder);
  background: var(--tagBg);
  color: var(--muted);
  padding:5px 10px;
  border-radius:999px;
  cursor:pointer;
}

.empty{
  padding:30px 0;
  text-align:center;
  color:var(--muted);
}

.footerRow{
  display:flex;
  justify-content:center;
  margin-top:20px;
}
</style>
</head>

<body>

<header class="topbar">
  <div class="wrap">
    <div class="brand">
      <span class="brand__dot"></span>
      Notes
    </div>

    <div class="topbar__right">
      <select id="sortSelect" class="sortSelect">
        <option value="new">Newest first</option>
        <option value="old">Oldest first</option>
      </select>

      <button id="themeToggle" class="themeBtn">Dark</button>
    </div>
  </div>
</header>

<!-- ✅ NEW: spacer so page content starts below the fixed bar -->
<div class="topInset" aria-hidden="true"></div>

<main class="layout">

<div class="timelineHead">
  <h1>Notes</h1>
  <div class="subtitle">Short-form writing, minimal and chronological.</div>

  <div class="controls">
    <input id="q" class="input" type="search" placeholder="Search…" />
    <select id="tag" class="select">
      <option value="">All tags</option>
    </select>
    <button id="clear" class="btn">Clear</button>
  </div>
</div>

<div id="feed" class="feed"></div>

<div class="footerRow">
  <button id="more" class="btn">Load more</button>
</div>

</main>

<script>
const posts=[
  {
    date:"2026-03-01T12:40:00Z",
    name:"Lewis",
    avatar:"https://lewis.lc/wiki/img/fractalavatar.png",
    text:"Building a minimal self-hosted microblog.\nFeels calm. Feels permanent.",
    tags:["web","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  {
    date:"2026-02-28T18:10:00Z",
    name:"Lewis",
    avatarText:"LC",
    text:"No algorithms.\nJust reverse chronological order.",
    tags:["writing","notes"]
  },
  
];

const PAGE_SIZE=10;
let visible=PAGE_SIZE;
let currentSort="new";

const feed=document.getElementById("feed");
const q=document.getElementById("q");
const tagSelect=document.getElementById("tag");
const more=document.getElementById("more");
const clear=document.getElementById("clear");
const sortSelect=document.getElementById("sortSelect");

/* Populate tag dropdown */
function populateTags(){
  const tagSet=new Set();
  posts.forEach(p=>(p.tags||[]).forEach(t=>tagSet.add(String(t).toLowerCase())));
  const sortedTags=[...tagSet].filter(Boolean).sort();
  tagSelect.innerHTML='<option value="">All tags</option>'+
    sortedTags.map(t=>`<option value="${t}">#${t}</option>`).join("");
}
populateTags();

/* Theme */
const root=document.documentElement;
const themeBtn=document.getElementById("themeToggle");
function applyTheme(theme){
  root.setAttribute("data-theme",theme);
  themeBtn.textContent=theme==="dark"?"Light":"Dark";
}
themeBtn.onclick=()=>{
  const next=root.getAttribute("data-theme")==="dark"?"light":"dark";
  localStorage.setItem("theme",next);
  applyTheme(next);
};
applyTheme(localStorage.getItem("theme")||"light");

/* Utils */
function initials(name=""){return name.split(" ").filter(Boolean).map(n=>n[0]).join("").slice(0,2).toUpperCase();}
function avatar(p){
  if(p.avatar) return `<img src="${p.avatar}" alt="">`;
  if(p.avatarText) return p.avatarText;
  return initials(p.name);
}
function relativeTime(iso){
  const now=new Date(), d=new Date(iso);
  const diff=(now-d)/1000;
  if(diff<15) return "now";
  if(diff<60) return Math.floor(diff)+"s";
  if(diff<3600) return Math.floor(diff/60)+"m";
  if(diff<86400) return Math.floor(diff/3600)+"h";

  const today=new Date(now.getFullYear(),now.getMonth(),now.getDate());
  const that=new Date(d.getFullYear(),d.getMonth(),d.getDate());
  const dayDiff=Math.round((today-that)/86400000);

  if(dayDiff===1) return "Yesterday";
  if(dayDiff<7) return dayDiff+"d";
  if(dayDiff<30) return Math.floor(dayDiff/7)+"w";
  return d.toLocaleDateString(undefined,{month:"short",day:"numeric"});
}
function getSorted(){
  return [...posts].sort((a,b)=>
    currentSort==="new"
      ? new Date(b.date)-new Date(a.date)
      : new Date(a.date)-new Date(b.date)
  );
}

/* Render */
function render(reset=false){
  if(reset) visible=PAGE_SIZE;

  const sorted=getSorted();
  const filtered=sorted.filter(p=>{
    const query=(q.value||"").toLowerCase();
    const tag=(tagSelect.value||"").toLowerCase();
    const text=(p.text||"").toLowerCase();
    const tags=(p.tags||[]).map(t=>String(t).toLowerCase());
    return (!query||text.includes(query)) &&
           (!tag||tags.includes(tag));
  });

  const slice=filtered.slice(0,visible);

  feed.innerHTML=slice.length?slice.map(p=>`
    <article class="post">
      <div class="post__avatar">${avatar(p)}</div>
      <div>
        <div class="post__top">
          <div class="post__name">${p.name}</div>
          <div class="post__time">· ${relativeTime(p.date)}</div>
        </div>
        <div class="post__text">${p.text}</div>
        ${(p.tags||[]).length?`
          <div class="tags">
            ${p.tags.map(t=>`<button class="tagBtn" type="button" data-tag="${t}">#${t}</button>`).join("")}
          </div>`:""}
      </div>
    </article>
  `).join(""):`<div class="empty">No posts found.</div>`;

  more.style.display=filtered.length>visible?"block":"none";

  feed.classList.remove("isAnimating");
  void feed.offsetWidth;
  feed.classList.add("isAnimating");
}

/* Events */
feed.onclick=e=>{
  const t=e.target?.dataset?.tag;
  if(t){ tagSelect.value=String(t).toLowerCase(); render(true); }
};
sortSelect.onchange=e=>{
  currentSort=e.target.value;
  render(true);
};
q.oninput=()=>render(true);
tagSelect.onchange=()=>render(true);
more.onclick=()=>{visible+=PAGE_SIZE; render();};
clear.onclick=()=>{q.value=""; tagSelect.value=""; render(true);};

render(true);
</script>

</body>
</html>
