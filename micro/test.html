<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Notes</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
/* ============ THEME TOKENS (Light default) ============ */
:root{
  --bg: #f5f5f7;
  --panel: #ffffff;
  --border: #e6e6e8;

  --text: #111111;
  --muted: #6e6e73;
  --muted2: #9b9ba1;

  --avatarBg: #e2e2e5;
  --tagBg: rgba(0,0,0,.04);
  --tagBorder: rgba(0,0,0,.10);

  --maxw: 720px;
}

/* ============ DARK (Deep navy / wobble-ish) ============ */
:root[data-theme="dark"]{
  --bg: #070814;          /* deep space */
  --panel: #0b1020;       /* navy panel */
  --border: rgba(255,255,255,.10);

  --text: rgba(255,255,255,.92);
  --muted: rgba(255,255,255,.65);
  --muted2: rgba(255,255,255,.48);

  --avatarBg: rgba(255,255,255,.10);
  --tagBg: rgba(255,255,255,.06);
  --tagBorder: rgba(255,255,255,.12);
}

*{box-sizing:border-box;}

body{
  margin:0;
  font-family:'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: var(--bg);
  color: var(--text);
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
}

button, input, select{
  font-family:'Inter', system-ui, sans-serif;
}

/* Top bar */
.topbar{
  position:sticky;
  top:0;
  z-index:20;
  height:56px;
  background:var(--panel);
  border-bottom:1px solid var(--border);
  display:flex;
  align-items:center;
}

.wrap{
  max-width:var(--maxw);
  margin:0 auto;
  padding:0 16px;
  width:100%;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.brand{
  font-weight:600;
  font-size:15px;
  display:flex;
  align-items:center;
  gap:8px;
}

.brand__dot{
  width:8px;
  height:8px;
  border-radius:999px;
  background: var(--text);
}

.topbar__right{
  display:flex;
  align-items:center;
  gap:10px;
}

.pill{
  font-size:13px;
  color:var(--muted);
}

.themeBtn{
  height:34px;
  padding:0 10px;
  border-radius:999px;
  border:1px solid var(--border);
  background:transparent;
  color:var(--text);
  font-size:13px;
  cursor:pointer;
}
.themeBtn:hover{ opacity:.92; }

/* Layout */
.layout{
  max-width:var(--maxw);
  margin:0 auto;
  padding:0 16px 40px;
}

.timelineHead{
  padding:20px 0 10px;
}

h1{
  margin:0;
  font-size:20px;
  font-weight:600;
}

.subtitle{
  margin-top:4px;
  font-size:13px;
  color:var(--muted);
}

.controls{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  margin-top:14px;
}

.input,.select{
  height:38px;
  border-radius:10px;
  border:1px solid var(--border);
  background: var(--panel);
  color: var(--text);
  padding:0 12px;
  font-size:14px;
}

.btn{
  height:38px;
  border-radius:999px;
  border:1px solid var(--border);
  background: var(--panel);
  color: var(--text);
  padding:0 14px;
  font-size:14px;
  cursor:pointer;
}

/* Feed */
.feed{ margin-top:10px; }

.post{
  display:grid;
  grid-template-columns:46px 1fr;
  gap:12px;
  padding:18px 0;
  border-bottom:1px solid var(--border);
}

.post__avatar{
  width:38px;
  height:38px;
  border-radius:999px;
  background: var(--avatarBg);
  overflow:hidden;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:600;
  font-size:13px;
  color: var(--text);
}

.post__avatar img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}

.post__top{
  display:flex;
  gap:8px;
  align-items:center;
  flex-wrap:wrap;
}

.post__name{
  font-weight:600;
  font-size:14px;
}

.post__time{
  font-size:13px;
  color:var(--muted2);
}

.post__text{
  margin:6px 0 8px;
  line-height:1.6;
  font-size:15px;
  white-space:pre-wrap;
}

/* Tags */
.tags{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  margin-top:6px;
}

.tagBtn{
  font-size:12px;
  color: var(--muted);
  border: 1px solid var(--tagBorder);
  background: var(--tagBg);
  padding: 5px 10px;
  border-radius: 999px;
  cursor:pointer;
}
.tagBtn:hover{
  opacity:.92;
  color: var(--text);
}

.empty{
  padding:30px 0;
  text-align:center;
  color:var(--muted);
}

.footerRow{
  display:flex;
  justify-content:center;
  margin-top:20px;
}
</style>
</head>

<body>

<header class="topbar">
  <div class="wrap">
    <div class="brand">
      <span class="brand__dot"></span>
      Notes
    </div>

    <div class="topbar__right">
      <div class="pill">Newest first</div>
      <button id="themeToggle" class="themeBtn" type="button" aria-label="Toggle dark mode">Dark</button>
    </div>
  </div>
</header>

<main class="layout">

<div class="timelineHead">
  <h1>Notes</h1>
  <div class="subtitle">Short-form writing, minimal and chronological.</div>

  <div class="controls">
    <input id="q" class="input" type="search" placeholder="Search…" />
    <select id="tag" class="select" aria-label="Filter by tag">
      <option value="">All tags</option>
    </select>
    <button id="clear" class="btn" type="button">Clear</button>
  </div>
</div>

<div id="feed" class="feed"></div>

<div class="footerRow">
  <button id="more" class="btn" type="button">Load more</button>
</div>

</main>

<script>
/* ======================
   EDIT YOUR POSTS HERE
   avatar: "url" for image
   avatarText: "LM" for initials
   tags: ["web","notes"]
====================== */
const posts = [
  {
    date: "2026-03-01T12:40:00Z",
    name: "Lewis",
    avatar: "https://lewis.lc/wiki/img/fractalavatar.png",
    text: "Building a minimal self-hosted microblog.\nFeels calm. Feels permanent.",
    tags: ["web","notes"]
  },
  {
    date: "2026-02-28T18:10:00Z",
    name: "Lewis Maddox",
    avatarText: "LM",
    text: "No algorithms.\nJust reverse chronological order.",
    tags: ["writing","notes"]
  }
];

const PAGE_SIZE = 10;
let visible = PAGE_SIZE;

const feed = document.getElementById("feed");
const q = document.getElementById("q");
const tagSelect = document.getElementById("tag");
const more = document.getElementById("more");
const clear = document.getElementById("clear");

/* ---- Theme (dark mode) ---- */
const root = document.documentElement;
const themeBtn = document.getElementById("themeToggle");

function applyTheme(theme){
  root.setAttribute("data-theme", theme);
  themeBtn.textContent = theme === "dark" ? "Light" : "Dark";
  themeBtn.setAttribute("aria-label", theme === "dark" ? "Switch to light mode" : "Switch to dark mode");
}

function initTheme(){
  const saved = localStorage.getItem("theme");
  if(saved === "light" || saved === "dark"){
    applyTheme(saved);
    return;
  }
  const prefersDark = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
  applyTheme(prefersDark ? "dark" : "light");
}
initTheme();

themeBtn.addEventListener("click", () => {
  const current = root.getAttribute("data-theme") || "light";
  const next = current === "dark" ? "light" : "dark";
  localStorage.setItem("theme", next);
  applyTheme(next);
});

/* ---- Utils ---- */
function escapeHtml(str=""){
  return String(str)
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}

function normalizeTag(t){ return String(t||"").trim().toLowerCase(); }

function initialsFromName(name=""){
  return name.split(" ").filter(Boolean).map(n=>n[0]).join("").slice(0,2).toUpperCase();
}

function renderAvatar(p){
  if(p.avatar){
    return `<img src="${escapeHtml(p.avatar)}" alt="">`;
  }
  if(p.avatarText){
    return escapeHtml(p.avatarText.toUpperCase());
  }
  return escapeHtml(initialsFromName(p.name));
}

/* ---- Sort newest first ---- */
const sorted = posts.slice().sort((a,b)=> new Date(b.date)-new Date(a.date));

/* ---- Tag dropdown ---- */
function allTags(){
  const set = new Set();
  sorted.forEach(p => (p.tags||[]).forEach(t => set.add(normalizeTag(t))));
  return Array.from(set).filter(Boolean).sort();
}

function renderTagOptions(){
  const tags = allTags();
  tagSelect.innerHTML =
    `<option value="">All tags</option>` +
    tags.map(t => `<option value="${escapeHtml(t)}">#${escapeHtml(t)}</option>`).join("");
}
renderTagOptions();

/* ---- Threads-ish relative time ---- */
function relativeTime(iso){
  const now = new Date();
  const d = new Date(iso);
  const diffMs = now - d;

  if (!isFinite(diffMs)) return "";

  const sec = Math.floor(diffMs / 1000);
  if (sec < 15) return "now";
  if (sec < 60) return `${sec}s`;

  const min = Math.floor(sec / 60);
  if (min < 60) return `${min}m`;

  const hr = Math.floor(min / 60);
  if (hr < 24) return `${hr}h`;

  // Yesterday check (local)
  const startOfToday = new Date(now.getFullYear(), now.getMonth(), now.getDate());
  const startOfThatDay = new Date(d.getFullYear(), d.getMonth(), d.getDate());

  const dayDiff = Math.round((startOfToday - startOfThatDay) / (1000*60*60*24));
  if (dayDiff === 1) return "Yesterday";
  if (dayDiff < 7) return `${dayDiff}d`;

  const wk = Math.floor(dayDiff / 7);
  if (wk < 5) return `${wk}w`;

  // older: "Mar 1"
  return d.toLocaleDateString(undefined, { month:"short", day:"numeric" });
}

/* ---- Search + filter ---- */
function matches(p){
  const query = q.value.trim().toLowerCase();
  const tagFilter = (tagSelect.value || "").toLowerCase();
  const text = (p.text||"").toLowerCase();
  const name = (p.name||"").toLowerCase();
  const tags = (p.tags||[]).map(normalizeTag);

  const qOk = !query || text.includes(query) || name.includes(query) || tags.some(t => t.includes(query));
  const tagOk = !tagFilter || tags.includes(tagFilter);
  return qOk && tagOk;
}

/* ---- Clickable tags -> set filter ---- */
feed.addEventListener("click", (e) => {
  const btn = e.target.closest("[data-tag]");
  if(!btn) return;
  const t = btn.getAttribute("data-tag");
  if(!t) return;
  tagSelect.value = t;
  render(true);
  tagSelect.focus();
});

/* ---- Render ---- */
function render(reset=false){
  if(reset) visible = PAGE_SIZE;

  const filtered = sorted.filter(matches);
  const slice = filtered.slice(0,visible);

  if(!slice.length){
    feed.innerHTML = `<div class="empty">No posts found.</div>`;
  }else{
    feed.innerHTML = slice.map(p => {
      const tags = (p.tags||[]).map(normalizeTag).filter(Boolean);
      const time = relativeTime(p.date);
      return `
        <article class="post">
          <div class="post__avatar">${renderAvatar(p)}</div>
          <div>
            <div class="post__top">
              <div class="post__name">${escapeHtml(p.name)}</div>
              <div class="post__time">· ${escapeHtml(time)}</div>
            </div>

            <div class="post__text">${escapeHtml(p.text)}</div>

            ${tags.length ? `
              <div class="tags">
                ${tags.map(t => `<button class="tagBtn" type="button" data-tag="${escapeHtml(t)}">#${escapeHtml(t)}</button>`).join("")}
              </div>
            ` : ``}
          </div>
        </article>
      `;
    }).join("");
  }

  more.style.display = filtered.length > visible ? "block" : "none";
}

q.addEventListener("input", ()=>render(true));
tagSelect.addEventListener("change", ()=>render(true));
more.addEventListener("click", ()=>{ visible += PAGE_SIZE; render(); });
clear.addEventListener("click", ()=>{
  q.value = "";
  tagSelect.value = "";
  render(true);
});

render(true);
</script>

</body>
</html>
